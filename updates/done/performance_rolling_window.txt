# Performance Scoring Rolling Window Update

## Objective
Update the performance multiplier calculation to use a configurable rolling window instead of the full season average, bringing it in line with how matchup scoring calculates defensive rankings. Also extend the simulation system to optimize MIN_WEEKS values for performance scoring.

## Current Behavior

### Performance Scoring (Step 5)
- Calculates average deviation across ALL weeks from 1 to CURRENT_NFL_WEEK
- Only filter: MIN_WEEKS minimum data requirement (currently 3)
- Season-long average means early-season performance affects score even in week 17

### Matchup Scoring (Step 6)
- Uses rolling window (MIN_WEEKS) for team defensive rankings
- Only considers recent weeks, capturing current defensive form
- More responsive to recent trends

## Proposed Changes

### 1. Update Performance Calculation to Use Rolling Window

**File**: `league_helper/util/player_scoring.py`

Update `calculate_performance_deviation()` to:
- Use MIN_WEEKS as the rolling window size (same behavior as other scoring parameters)
- Only analyze the most recent MIN_WEEKS weeks instead of all weeks
- If fewer than MIN_WEEKS weeks available, return None (insufficient data)

**Example**:
```python
# Current: for week in range(1, self.config.current_nfl_week)
# New: for week in range(max(1, self.config.current_nfl_week - min_weeks), self.config.current_nfl_week)
```

This makes MIN_WEEKS behave consistently with how it's used in matchup and other scoring parameters - as both the minimum required weeks AND the window size.

### 2. Update Simulation ConfigGenerator

**File**: `simulation/ConfigGenerator.py`

Add PERFORMANCE_SCORING MIN_WEEKS to the parameter space for optimization:
- Range: 2-8 weeks (reasonable bounds)
- Allow simulation to find optimal window size

### 3. Update Documentation

**File**: `docs/scoring/05_performance_multiplier.md`

- Document rolling window behavior
- Update code examples
- Add examples showing how window size affects calculations


