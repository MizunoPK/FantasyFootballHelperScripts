CONSISTENCY/VOLATILITY SCORING IMPROVEMENT
==========================================

OVERVIEW
--------
Add consistency/volatility analysis to differentiate between reliable weekly performers and boom/bust players. This improvement applies universally across ALL fantasy helper modes:

DRAFT HELPER (3 modes):
- ✅ Add to Roster (draft recommendations)
- ✅ Waiver Optimizer (trade analysis)
- ✅ Trade Simulator (simulated trades)

STARTER HELPER (1 mode):
- ✅ Weekly Lineup Optimization (optimal starters)

Consistent players (low week-to-week variance) receive scoring boost, while volatile boom/bust players receive penalty.

PROBLEM STATEMENT
-----------------
Current scoring only considers total projected fantasy points (season total or average). This treats two players identically if they have the same season total:
- Player A: 12 points every week (consistent)
- Player B: 24 points half the weeks, 0 points the other half (volatile)

Both have same season total but Player A is more valuable for roster stability, while Player B might be better for high-risk/high-reward strategies.

SOLUTION APPROACH
-----------------
Calculate standard deviation across weekly projections (weeks 1-17) and apply universal consistency multipliers (same across all positions for simplicity).

IMPLEMENTATION DETAILS
----------------------

1. DATA CALCULATION (NEW CALCULATOR CLASS)
   Location: shared_files/consistency_calculator.py

   Class: ConsistencyCalculator

   Method: calculate_consistency_score(player: FantasyPlayer) -> Dict[str, float]

   Steps:
   a) Extract weekly projections (weeks 1-17)
      weekly_points = [player.week_1_points, player.week_2_points, ..., player.week_17_points]

   b) Filter out None values (missing weeks)
      valid_weeks = [pts for pts in weekly_points if pts is not None]

   c) Calculate metrics:
      - mean_points = sum(valid_weeks) / len(valid_weeks)
      - std_dev = standard_deviation(valid_weeks)
      - coefficient_of_variation = std_dev / mean_points if mean_points > 0 else 0

   d) Categorize volatility:
      - LOW: CV < 0.3 (consistent performer)
      - MEDIUM: 0.3 <= CV <= 0.6 (moderate variance)
      - HIGH: CV > 0.6 (boom/bust player)

   Return:
   {
       'mean_points': float,
       'std_dev': float,
       'coefficient_of_variation': float,
       'volatility_category': str,  # LOW, MEDIUM, HIGH
       'consistency_multiplier': float  # Based on position and CV
   }

2. UNIVERSAL CONSISTENCY MULTIPLIERS

   Configuration: shared_files/configs/draft_helper_config.py

   # Simple universal multipliers applied to all positions
   # Rewards consistency, penalizes boom/bust volatility
   CONSISTENCY_MULTIPLIERS = {
       'LOW': 1.08,      # Reward consistent performers (CV < 0.3)
       'MEDIUM': 1.00,   # Neutral (0.3 <= CV <= 0.6)
       'HIGH': 0.92      # Penalize boom/bust players (CV > 0.6)
   }

   Note: These multipliers apply universally across all positions (QB, RB, WR, TE, K, DST).
   This simplification avoids complexity of position-tier tracking while still differentiating
   consistent vs volatile players.

   Future Enhancement: Could differentiate by position if simulation results show benefit.
   For example:
   - RB/WR could value consistency more (weekly starters)
   - K/DST could be neutral (easier to stream/replace)
   - Bench players could reward volatility (upside potential)

3. INTEGRATION INTO SCORING ENGINES

   ⚠️ IMPORTANT: Consistency scoring must be added to THREE locations:

   DRAFT HELPER (draft_helper/core/scoring_engine.py):
   - score_player() - Used by "Add to Roster" mode (draft recommendations)
   - score_player_for_trade() - Used by "Waiver Optimizer" and "Trade Simulator" modes

   STARTER HELPER (starter_helper/lineup_optimizer.py):
   - calculate_adjusted_score() - Used by "Weekly Lineup Optimization" mode

   All three methods need the same consistency calculation applied.

   A. UPDATED score_player() - ADD TO ROSTER MODE (7-step becomes 8-step):

   def score_player(self, p, enhanced_scorer=None, team_data_loader=None,
                    positional_ranking_calculator=None, consistency_calculator=None):
       """
       Calculate score for Add to Roster Mode (8-step calculation).

       New Scoring System:
       1. Get normalized seasonal fantasy points (0-N scale)
       2. Apply ADP multiplier
       3. Apply Player Ranking multiplier
       4. Apply Team ranking multiplier
       5. Apply CONSISTENCY multiplier (NEW - universal across positions)
       6. Add DRAFT_ORDER bonus (round-based position priority)
       7. Subtract Bye Week penalty
       8. Subtract Injury penalty
       """
       # STEP 1: Normalize
       normalized_score = self.normalization_calculator.normalize_player(p, self.players)

       # STEPS 2-4: Enhanced scoring (ADP, Player Rating, Team)
       enhanced_score = self._apply_enhanced_scoring(...)

       # STEP 5: Apply CONSISTENCY multiplier (NEW - universal)
       if consistency_calculator:
           consistency_result = consistency_calculator.calculate_consistency_score(p)
           volatility_category = consistency_result['volatility_category']

           # Get universal multiplier (same for all positions)
           from shared_files.configs.draft_helper_config import CONSISTENCY_MULTIPLIERS
           consistency_multiplier = CONSISTENCY_MULTIPLIERS.get(volatility_category, 1.0)

           consistency_score = enhanced_score * consistency_multiplier
           self.logger.debug(
               f"Step 5 - After consistency for {p.name}: {consistency_score:.2f} "
               f"({volatility_category} volatility, CV={consistency_result['coefficient_of_variation']:.3f}, "
               f"{consistency_multiplier:.2f}x)"
           )
       else:
           consistency_score = enhanced_score

       # STEP 6: Draft Order bonus
       draft_bonus = self.draft_order_calculator.calculate_bonus(p)
       draft_bonus_score = consistency_score + draft_bonus

       # STEP 7: Bye penalty
       bye_penalty = self.compute_bye_penalty_for_player(p)
       bye_adjusted_score = draft_bonus_score - bye_penalty

       # STEP 8: Injury penalty
       injury_penalty = self.compute_injury_penalty(p)
       final_score = bye_adjusted_score - injury_penalty

       return final_score

   B. UPDATED score_player_for_trade() - WAIVER/TRADE MODE (6-step becomes 7-step):

   def score_player_for_trade(self, player, positional_ranking_calculator=None,
                               enhanced_scorer=None, team_data_loader=None,
                               consistency_calculator=None):
       """
       Calculate score for Trade/Waiver Mode (7-step calculation).

       ⚠️ CRITICAL: This method is used by BOTH:
       - Waiver Optimizer mode
       - Trade Simulator mode

       New Scoring System (same as Add to Roster but WITHOUT DRAFT_ORDER bonus):
       1. Get normalized seasonal fantasy points (0-N scale)
       2. Apply ADP multiplier
       3. Apply Player Ranking multiplier
       4. Apply Team ranking multiplier
       5. Apply CONSISTENCY multiplier (NEW - universal across positions)
       6. Subtract Bye Week penalty
       7. Subtract Injury penalty

       Note: No DRAFT_ORDER bonus - that's only for draft recommendations
       """
       # STEP 1: Normalize seasonal fantasy points to 0-N scale
       normalized_score = self.normalization_calculator.normalize_player(player, self.players)

       # STEPS 2-4: Apply enhanced scoring (ADP, Player Ranking, Team Ranking multipliers)
       enhanced_score = self._apply_enhanced_scoring(
           normalized_score, player, enhanced_scorer, team_data_loader, positional_ranking_calculator
       )

       # STEP 5: Apply CONSISTENCY multiplier (NEW - universal, same as Add to Roster)
       if consistency_calculator:
           consistency_result = consistency_calculator.calculate_consistency_score(player)
           volatility_category = consistency_result['volatility_category']

           # Get universal multiplier (same for all positions)
           from shared_files.configs.draft_helper_config import CONSISTENCY_MULTIPLIERS
           consistency_multiplier = CONSISTENCY_MULTIPLIERS.get(volatility_category, 1.0)

           consistency_score = enhanced_score * consistency_multiplier
           self.logger.debug(
               f"Step 5 - After consistency for {player.name}: {consistency_score:.2f} "
               f"({volatility_category} volatility, CV={consistency_result['coefficient_of_variation']:.3f}, "
               f"{consistency_multiplier:.2f}x)"
           )
       else:
           consistency_score = enhanced_score

       # NOTE: No DRAFT_ORDER bonus for trade/waiver mode (Step 6 from Add to Roster is skipped)

       # STEP 6: Subtract Bye Week penalty (exclude self if roster player)
       exclude_self = (player.drafted == 2)
       bye_penalty = self.compute_bye_penalty_for_player(player, exclude_self=exclude_self)
       bye_adjusted_score = consistency_score - bye_penalty

       # STEP 7: Subtract Injury penalty
       injury_penalty = self.compute_injury_penalty(player, trade_mode=True)
       final_score = bye_adjusted_score - injury_penalty

       return final_score

   C. UPDATED calculate_adjusted_score() - STARTER HELPER MODE (3-step becomes 4-step):

   def calculate_adjusted_score(self,
                                projected_points: float,
                                injury_status: str,
                                bye_week: int,
                                player_team: Optional[str] = None,
                                player_position: Optional[str] = None,
                                player: Optional[FantasyPlayer] = None,
                                consistency_calculator=None) -> Tuple[float, str]:
       """
       Calculate adjusted score for Starter Helper Mode (4-step calculation).

       ⚠️ CRITICAL: This method is used by:
       - Weekly Lineup Optimization mode (starter_helper)

       New Scoring System:
       1. Start with projected points for current week
       2. Apply CONSISTENCY multiplier (NEW - universal across positions)
       3. Apply matchup multiplier (if positional ranking available)
       4. Apply binary injury penalty (zero out non-ACTIVE/QUESTIONABLE players)

       Args:
           projected_points: Current week projected fantasy points
           injury_status: Player injury status
           bye_week: Player's bye week number (not used in current scoring)
           player_team: Player's team abbreviation (e.g., 'PHI', 'KC')
           player_position: Player position (e.g., 'QB', 'RB', 'WR')
           player: FantasyPlayer object (needed for consistency calculation)
           consistency_calculator: ConsistencyCalculator instance

       Returns:
           Tuple of (adjusted_score, reason_string)
       """
       adjusted_score = projected_points
       reasons = []

       # STEP 2: Apply CONSISTENCY multiplier (NEW - universal, same as Draft Helper)
       if consistency_calculator and player:
           consistency_result = consistency_calculator.calculate_consistency_score(player)
           volatility_category = consistency_result['volatility_category']

           # Get universal multiplier (same for all positions)
           from shared_files.configs.draft_helper_config import CONSISTENCY_MULTIPLIERS
           consistency_multiplier = CONSISTENCY_MULTIPLIERS.get(volatility_category, 1.0)

           adjusted_score = adjusted_score * consistency_multiplier

           # Add to reasons if adjustment applied
           if consistency_multiplier != 1.0:
               cv = consistency_result['coefficient_of_variation']
               reasons.append(f"Consistency: {consistency_multiplier:.2f}x (CV={cv:.3f})")

       # STEP 3: Apply matchup multiplier if available
       if (self.matchup_calculator and
           self.matchup_calculator.is_matchup_available() and
           player_team and player_position):

           matchup_adjusted_points, matchup_explanation = self.matchup_calculator.calculate_matchup_adjustment(
               player_team=player_team,
               position=player_position,
               base_points=adjusted_score
           )

           # Apply the matchup adjustment
           adjusted_score = matchup_adjusted_points

           # Add explanation if provided
           if matchup_explanation:
               reasons.append(matchup_explanation)

       # STEP 4: Apply binary injury penalty (zero out non-active players)
       if injury_status.upper() not in STARTER_HELPER_ACTIVE_STATUSES:
           adjusted_score = 0.0
           reasons.append(f"Inactive ({injury_status})")

       reason = "; ".join(reasons) if reasons else "No adjustments"
       return max(0.0, adjusted_score), reason

4. EXAMPLE CALCULATION

   Scenario: Evaluating two RBs with same season projections

   Player A (Consistent): Kareem Hunt
   - Week 1: 12.5 pts, Week 2: 14.2 pts, Week 3: 11.8 pts
   - Week 4: 13.1 pts, Week 5: 12.9 pts, ... (continues through week 17)
   - Mean: 12.8 pts/week
   - Std Dev: 1.2 pts
   - CV: 1.2 / 12.8 = 0.094 (LOW volatility - very consistent)
   - Consistency Multiplier: 1.08 (universal LOW multiplier)

   Score Impact:
   - Before consistency: 85.5 pts
   - After consistency: 85.5 * 1.08 = 92.34 pts (+6.84)

   Player B (Volatile): Boom/Bust RB
   - Alternates: 24 pts, 0 pts, 22 pts, 2 pts, 26 pts, 1 pts, ...
   - Mean: 12.8 pts/week (same season average!)
   - Std Dev: 8.5 pts
   - CV: 8.5 / 12.8 = 0.664 (HIGH volatility - boom/bust)
   - Consistency Multiplier: 0.92 (universal HIGH multiplier)

   Score Impact:
   - Before consistency: 85.5 pts
   - After consistency: 85.5 * 0.92 = 78.66 pts (-6.84)

   Difference: 13.68 points favor the consistent player

   Note: Both players have identical season projections (12.8 pts/week average),
   but consistency scoring rewards reliable weekly performance over boom/bust variance.

5. CONFIGURATION TOGGLES

   Location: shared_files/configs/draft_helper_config.py

   # Enable/disable consistency scoring
   ENABLE_CONSISTENCY_SCORING = True

   # Universal consistency multipliers
   CONSISTENCY_MULTIPLIERS = {
       'LOW': 1.08,      # CV < 0.3 (consistent)
       'MEDIUM': 1.00,   # 0.3 <= CV <= 0.6 (moderate)
       'HIGH': 0.92      # CV > 0.6 (volatile)
   }

   # Consistency weight tuning (scales impact)
   CONSISTENCY_WEIGHT = 1.0  # 1.0 = full impact, 0.5 = half impact, 1.5 = stronger

   # Applied as: adjusted_multiplier = 1.0 + (base_multiplier - 1.0) * CONSISTENCY_WEIGHT
   # Example: base=1.08, weight=0.5 -> adjusted=1.04
   #          base=1.08, weight=1.5 -> adjusted=1.12

   # Volatility thresholds (coefficient of variation)
   CONSISTENCY_CV_LOW_THRESHOLD = 0.3    # Below this = LOW volatility
   CONSISTENCY_CV_HIGH_THRESHOLD = 0.6   # Above this = HIGH volatility
   # Between thresholds = MEDIUM volatility

6. INTEGRATION ACROSS ALL MODES

   ⚠️ CRITICAL IMPLEMENTATION NOTE:
   The consistency calculator must be passed to ALL scoring methods across BOTH helper modules.

   A. DRAFT HELPER INTEGRATION (draft_helper.py):

   def score_player_for_trade(self, player):
       """
       Modified scoring function for trade evaluation.
       Used by BOTH Waiver Optimizer and Trade Simulator modes.
       """
       return self.scoring_engine.score_player_for_trade(
           player,
           positional_ranking_calculator=self.positional_ranking_calculator,
           enhanced_scorer=self.enhanced_scorer,
           team_data_loader=self.team_data_loader,
           consistency_calculator=self.consistency_calculator  # ← ADD THIS
       )

   In draft_helper.__init__():

   # Initialize consistency calculator (add this to __init__)
   try:
       from shared_files.consistency_calculator import ConsistencyCalculator
       self.consistency_calculator = ConsistencyCalculator(logger=self.logger)
       self.logger.info("Consistency calculator initialized")
   except Exception as e:
       self.logger.warning(f"Failed to initialize consistency calculator: {e}")
       self.consistency_calculator = None

   B. STARTER HELPER INTEGRATION (starter_helper/lineup_optimizer.py):

   In LineupOptimizer.__init__():

   # Initialize consistency calculator (add this to __init__)
   try:
       from shared_files.consistency_calculator import ConsistencyCalculator
       self.consistency_calculator = ConsistencyCalculator(logger=self.logger)
       self.logger.info("Consistency calculator initialized")
   except Exception as e:
       self.logger.warning(f"Failed to initialize consistency calculator: {e}")
       self.consistency_calculator = None

   In create_starting_recommendation():

   def create_starting_recommendation(self,
                                    player_data: Dict,
                                    projected_points: float) -> StartingRecommendation:
       """
       Create a StartingRecommendation from player data
       """
       injury_status = player_data.get('injury_status', 'ACTIVE')
       bye_week = int(player_data.get('bye_week', 0))

       # Convert player_data dict to FantasyPlayer for consistency calculation
       from shared_files.FantasyPlayer import FantasyPlayer
       player = FantasyPlayer.from_dict(player_data)

       adjusted_score, reason = self.calculate_adjusted_score(
           projected_points, injury_status, bye_week,
           player_team=player_data['team'],
           player_position=player_data['position'],
           player=player,  # ← ADD THIS
           consistency_calculator=self.consistency_calculator  # ← ADD THIS
       )

       return StartingRecommendation(...)

   MODES AFFECTED (ALL 4):
   - ✅ Add to Roster (uses score_player)
   - ✅ Waiver Optimizer (uses score_player_for_trade)
   - ✅ Trade Simulator (uses score_player_for_trade)
   - ✅ Weekly Lineup Optimization (uses calculate_adjusted_score)

   All four modes will apply the same universal consistency multipliers.

7. TESTING REQUIREMENTS

   Unit Tests (shared_files/tests/test_consistency_calculator.py):
   - Test CV calculation with known data
   - Test volatility categorization (LOW/MEDIUM/HIGH)
   - Test multiplier lookup (universal multipliers)
   - Test edge cases:
     * All weeks same points (CV = 0, should be LOW)
     * Missing weeks (None values filtered out)
     * Single week of data (insufficient, handle gracefully)
     * Zero mean points (avoid division by zero)
     * Very high variance (CV > 1.0)

   Integration Tests - Draft Helper (draft_helper/tests/test_scoring_engine_consistency.py):
   - Test consistency step in score_player() (Add to Roster mode)
   - Test consistency step in score_player_for_trade() (Waiver/Trade mode)
   - Verify both methods apply same consistency multipliers
   - Verify consistent player (CV < 0.3) scores higher than volatile (CV > 0.6)
   - Test universal application (same multipliers for QB, RB, WR, TE, K, DST)
   - Test with/without consistency_calculator parameter
   - Test CONSISTENCY_WEIGHT scaling

   Integration Tests - Starter Helper (starter_helper/tests/test_lineup_optimizer_consistency.py):
   - Test consistency step in calculate_adjusted_score()
   - Verify consistent player scores higher than volatile player
   - Test with/without consistency_calculator parameter
   - Verify integration with matchup multipliers (consistency applied BEFORE matchup)
   - Test that consistency doesn't affect injury zeroing (applied BEFORE injury check)

   End-to-End Tests (manual validation):
   - Test Add to Roster mode shows consistency-adjusted recommendations
   - Test Waiver Optimizer mode applies consistency to trade suggestions
   - Test Trade Simulator mode uses consistency in score comparisons
   - Test Weekly Lineup Optimization mode uses consistency in starter recommendations
   - Verify consistent players ranked higher across all four modes

8. SIMULATION INTEGRATION

   Add to simulation parameters:

   PARAMETER_RANGES in draft_helper/simulation/parameters/*.json:
   {
       ...existing parameters...,

       "CONSISTENCY_LOW_MULTIPLIER": [1.05, 1.08, 1.12],
       "CONSISTENCY_HIGH_MULTIPLIER": [0.88, 0.92, 0.95],
       "CONSISTENCY_CV_LOW_THRESHOLD": [0.25, 0.30, 0.35],
       "CONSISTENCY_CV_HIGH_THRESHOLD": [0.55, 0.60, 0.65]
   }

   Test different multiplier values and thresholds to find optimal balance.
   Measure impact on win rates compared to baseline (no consistency scoring).

BENEFITS
--------
1. Better differentiation between similar-projection players
2. Rewards reliable weekly performance over boom/bust variance
3. Simple universal system (no position-tier complexity)
4. Uses existing data (weekly projections already available)
5. Easy to tune via simulation (just 2 multipliers + 2 thresholds)
6. Helps with trade decisions (consistent depth vs volatile upside)

POTENTIAL DOWNSIDES
-------------------
1. Adds complexity to scoring system
2. May over-reward consistency at expense of upside potential
3. Requires sufficient weekly projection data (need weeks 1-17)
4. Universal multipliers don't account for position-specific variance
   (e.g., WRs are naturally more volatile than RBs)
5. May not apply well to rookies with limited projection data

CONFIGURATION TUNING
--------------------
Start conservative:
- CONSISTENCY_LOW_MULTIPLIER = 1.05 (gentle reward)
- CONSISTENCY_HIGH_MULTIPLIER = 0.95 (gentle penalty)
- Run simulations to measure win rate impact
- Gradually increase spread if positive results

Monitor for:
- Over-drafting consistent but mediocre players (high floor, low ceiling)
- Under-drafting high-upside volatile players (league winners)
- Position-specific issues (are WRs being over-penalized for natural variance?)

If position-specific tuning needed:
- Future enhancement: different multipliers by position
- Could implement tier-based system (starter vs bench) later

FUTURE ENHANCEMENTS
-------------------
1. Position-specific multipliers (if simulations show need)
   - Different thresholds for QB/RB/WR/TE/K/DST
   - Tier-based multipliers (starter vs bench vs depth)
2. Factor in opponent strength variance (easy schedule vs hard schedule)
3. Weight recent weeks more heavily (trending up/down)
4. Apply different multipliers for PPR vs Standard scoring formats
5. Incorporate "ceiling weeks" (how often they hit 20+ points)
6. Add "floor weeks" (how often they score under 5 points)
7. Differentiate "good variance" (upside) vs "bad variance" (inconsistency)

IMPLEMENTATION CHECKLIST
------------------------
[ ] Create shared_files/consistency_calculator.py
    - Implement calculate_consistency_score() method
    - Handle edge cases (missing weeks, zero mean, etc.)
[ ] Add CONSISTENCY_MULTIPLIERS to draft_helper_config.py
    - Universal multipliers (LOW/MEDIUM/HIGH)
    - CV thresholds (LOW_THRESHOLD, HIGH_THRESHOLD)
    - ENABLE_CONSISTENCY_SCORING toggle
    - CONSISTENCY_WEIGHT tuning parameter

[ ] ⚠️ Update draft_helper/core/scoring_engine.py - BOTH METHODS REQUIRED:
    A. Update score_player() method:
       - Add consistency_calculator parameter
       - Apply consistency multiplier at step 5 (after enhanced scoring)
       - Update logging to show CV and category
    B. Update score_player_for_trade() method:
       - Add consistency_calculator parameter
       - Apply consistency multiplier at step 5 (same as above)
       - Update logging to show CV and category
    ⚠️ CRITICAL: Both methods must apply identical consistency logic

[ ] ⚠️ Update starter_helper/lineup_optimizer.py - METHOD UPDATE REQUIRED:
    A. Update calculate_adjusted_score() method:
       - Add player parameter (FantasyPlayer object)
       - Add consistency_calculator parameter
       - Apply consistency multiplier at step 2 (BEFORE matchup, BEFORE injury)
       - Add consistency info to reasons list
    B. Update create_starting_recommendation() method:
       - Convert player_data dict to FantasyPlayer object
       - Pass player to calculate_adjusted_score()
       - Pass consistency_calculator to calculate_adjusted_score()
    ⚠️ CRITICAL: Apply consistency BEFORE matchup and BEFORE injury check

[ ] Update draft_helper.py initialization
    - Import ConsistencyCalculator in __init__
    - Initialize self.consistency_calculator
    - Pass consistency_calculator to score_player()
    - Pass consistency_calculator to score_player_for_trade()
    ⚠️ Verify all three Draft Helper modes use consistency

[ ] Update starter_helper/lineup_optimizer.py initialization
    - Import ConsistencyCalculator in __init__
    - Initialize self.consistency_calculator
    ⚠️ Verify Weekly Lineup Optimization mode uses consistency

[ ] Write unit tests for ConsistencyCalculator
    - Test CV calculation accuracy
    - Test volatility categorization
    - Test edge cases

[ ] Write integration tests for Draft Helper scoring engine
    - Test score_player() with consistency (Add to Roster)
    - Test score_player_for_trade() with consistency (Waiver/Trade)
    - Verify both methods produce consistent results
    - Test universal application across positions
    - Test CONSISTENCY_WEIGHT scaling

[ ] Write integration tests for Starter Helper lineup optimizer
    - Test calculate_adjusted_score() with consistency
    - Verify consistency applied before matchup multiplier
    - Verify consistency applied before injury check
    - Test with/without consistency_calculator parameter

[ ] End-to-end validation (manual testing - ALL 4 MODES)
    - Run Add to Roster mode, verify consistency adjustments shown
    - Run Waiver Optimizer mode, verify consistency affects recommendations
    - Run Trade Simulator mode, verify consistency in score comparisons
    - Run Weekly Lineup Optimization mode, verify consistency in starter picks
    - Confirm consistent players ranked higher in all four modes

[ ] Add consistency parameters to simulation config
    - CONSISTENCY_LOW_MULTIPLIER
    - CONSISTENCY_HIGH_MULTIPLIER
    - CV thresholds

[ ] Update CLAUDE.md documentation
    - Add consistency scoring to 8-step Add to Roster process (Draft Helper)
    - Add consistency scoring to 7-step Waiver/Trade process (Draft Helper)
    - Add consistency scoring to 4-step Weekly Lineup process (Starter Helper)
    - Document configuration options
    - Note that all four modes use consistency scoring

[ ] Run baseline simulations to measure impact
    - Test with consistency on vs off
    - Measure win rate differences across all modes

[ ] Tune multiplier values based on results
    - Start conservative (1.05/0.95)
    - Increase spread if beneficial

ESTIMATED EFFORT
----------------
Development: 4-5 hours
  - ConsistencyCalculator class: 1 hour
  - Draft Helper integration:
    * score_player() integration: 30 min
    * score_player_for_trade() integration: 30 min
    * draft_helper.py initialization: 30 min
  - Starter Helper integration:
    * calculate_adjusted_score() integration: 45 min
    * lineup_optimizer.py initialization: 15 min
  - Configuration setup: 30 min
Testing: 2.5 hours
  - Unit tests: 1 hour
  - Draft Helper integration tests: 45 min
  - Starter Helper integration tests: 30 min
  - Manual validation (all 4 modes): 45 min
Simulation/Tuning: 1-2 hours
Total: 7.5-9.5 hours

PRIORITY: HIGH
This improvement uses existing data (weekly projections) and provides clear value differentiation without requiring external data sources.

⚠️ CRITICAL SUCCESS FACTORS:
1. MUST update THREE scoring methods:
   - score_player() in Draft Helper
   - score_player_for_trade() in Draft Helper
   - calculate_adjusted_score() in Starter Helper
2. MUST pass consistency_calculator to all three methods
3. MUST test all four modes:
   - Add to Roster (Draft Helper)
   - Waiver Optimizer (Draft Helper)
   - Trade Simulator (Draft Helper)
   - Weekly Lineup Optimization (Starter Helper)
4. All three scoring methods must apply identical consistency logic
5. Starter Helper applies consistency BEFORE matchup and BEFORE injury check
